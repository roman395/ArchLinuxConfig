#!/bin/bash

# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è, –≥–¥–µ –ª–µ–∂–∞—Ç –∫–æ–Ω—Ñ–∏–≥–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
CONFIG_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
# –ú–∞—Å—Å–∏–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–π: "—Ñ–∞–π–ª_–≤_—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ -> –∫—É–¥–∞_–ø–æ–ª–æ–∂–∏—Ç—å_–≤_—Å–∏—Å—Ç–µ–º–µ"
declare -A CONFIG_MAP=(
    [".zshrc"]="$HOME/.zshrc"
    ["hyprland.conf"]="$HOME/.config/hypr/hyprland.conf"
    ["kitty.conf"]="$HOME/.config/kitty/kitty.conf"

)

echo "üîπ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤ —á–µ—Ä–µ–∑ —Å–∏–º–ª–∏–Ω–∫–∏..."

# –°–æ–∑–¥–∞–µ–º —Å–∏–º–ª–∏–Ω–∫–∏
for file in "${!CONFIG_MAP[@]}"; do
    target="${CONFIG_MAP[$file]}"
    echo "üî∏ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é: $file ‚Üí $target"

    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∏—Å—Ö–æ–¥–Ω—ã–π —Ñ–∞–π–ª
    if [[ ! -f "$CONFIG_DIR/$file" ]]; then
        echo "‚ö† –û—à–∏–±–∫–∞: —Ñ–∞–π–ª $file –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏!"
        continue
    fi

    # –ï—Å–ª–∏ —Ü–µ–ª–µ–≤–æ–π —Ñ–∞–π–ª —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –¥–µ–ª–∞–µ–º –±—ç–∫–∞–ø
    if [[ -f "$target" || -L "$target" ]]; then
        echo "üîπ –§–∞–π–ª $target —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞—é –±—ç–∫–∞–ø..."
        mv "$target" "$target.bak"
    fi

    # –°–æ–∑–¥–∞–µ–º –ø–∞–ø–∫—É, –µ—Å–ª–∏ –µ—ë –Ω–µ—Ç
    mkdir -p "$(dirname "$target")"

    # –°–æ–∑–¥–∞–µ–º —Å–∏–º–ª–∏–Ω–∫
    ln -s "$CONFIG_DIR/$file" "$target"
    echo "‚úÖ –°–∏–º–ª–∏–Ω–∫ —Å–æ–∑–¥–∞–Ω: $file ‚Üí $target"
done

echo "‚ú® –ì–æ—Ç–æ–≤–æ! –ö–æ–Ω—Ñ–∏–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã."
